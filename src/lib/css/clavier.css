bloc-clavier {
	--taille-clavier: 0.9; /* Pourcentage de la longueur de la page */
    --marge-clavier: calc(var(--marge-touche) * 5);
    --arrondi-clavier: calc(var(--marge-touche) * 3.5);
    
    --taille-touche: calc(var(--taille-clavier) * 100vw / 15);
    --hauteur-touche: calc(var(--taille-touche) - 2 * var(--marge-touche));
    --profondeur-touche: calc(var(--taille-clavier) * 0.25vw);
    --profondeur-touche-pressee: calc(var(--taille-clavier) * 0.1vw);
    --marge-touche: calc(var(--taille-clavier) * 0.36vw);
    --arrondi-touche: 0.15em;
    --ombre-touche: rgba(0, 0, 0, 0.3) 5px 3px 5px;
    --descente-touche: calc(var(--profondeur-touche) - var(--profondeur-touche-pressee));

    --couleur-touche-saturation: 70%;
    --couleur-touche-luminosite: 80%;
    --couleur-texte-touche: hsla(0, 100%, 100%, 90%);
	--transparence-touche: 15%;
	
	--transparence-touche-pressee: 10%;
    --couleur-touche-pressee-luminosite: 60%;

    --couleur-doigt-gauche-index: 0deg;
    --couleur-doigt-gauche-majeur: 25deg;
    --couleur-doigt-gauche-annulaire: 50deg;
    --couleur-doigt-gauche-auriculaire: 100deg;
    --couleur-doigt-droite-index: -40deg;
    --couleur-doigt-droite-majeur: -100deg;
    --couleur-doigt-droite-annulaire: -140deg;
    --couleur-doigt-droite-auriculaire: -170deg;

    display: block;
    width: max-content;
    margin: 0 auto;
    padding: var(--marge-clavier);
    background-color:hsla(234, 20%, 15%, 0.1);
    border: 1px solid hsla(0deg, 0%, 100%, 30%);
    border-radius: var(--arrondi-clavier);
	box-shadow: 0 0 10px 1px rgba(0, 99, 170, 0.8);
	font-weight: 300;
}

@media (max-width: 700px) {
	bloc-clavier {
		--taille-clavier: 0.9; /* Pourcentage de la longueur de la page */
	}
}



ensemble-clavier[data-type="ergodox"] bloc-touche[data-colonne="6"] {
	margin-right: 5vw;
}

bloc-ligne {
    display: flex;
}



bloc-touche {
    --longueur-touche: calc(var(--taille-touche) * var(--taille) - 2 * var(--marge-touche));
    --effet-3d: hsla(var(--couleur-touche), var(--couleur-touche-saturation), calc(var(--couleur-touche-luminosite) - 20%), 70%);
    --ombres-touche: var(--ombre-touche), 0 var(--profondeur-touche) 0 var(--effet-3d);
    --couleur-fond-touche: hsla(var(--couleur-touche), var(--couleur-touche-saturation), var(--couleur-touche-luminosite), var(--transparence-touche));
    --couleur-bordure-touche: hsla(var(--couleur-touche), var(--couleur-touche-saturation), var(--couleur-touche-luminosite), 30%);
    --taille-bordure-touche: 1px; /* calc(var(--taille-clavier) * 0.1rem) */
    --taille-texte-touche: calc(var(--taille-touche) / 2.5);
    
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    height: var(--hauteur-touche);
    width: var(--longueur-touche);
    margin: var(--marge-touche);
    border: var(--taille-bordure-touche) solid var(--couleur-bordure-touche);
    border-radius: var(--arrondi-touche);
    background-color: var(--couleur-fond-touche);
    box-shadow: var(--ombres-touche);
    color: var(--couleur-texte-touche);
    cursor: pointer;
    font-size: var(--taille-texte-touche);
}

bloc-touche[data-touche=""] {
	display: none;
}

bloc-touche:active,
bloc-touche:hover,
.touche-active {
	--couleur-fond-touche: hsla(var(--couleur-touche), var(--couleur-touche-saturation), var(--couleur-touche-pressee-luminosite), var(--transparence-touche-pressee));
    position: relative;
    top: var(--descente-touche);
    box-shadow: 0 var(--profondeur-touche-pressee) 0 var(--effet-3d);
}







/*
============================================
======= Style par touches et couches =======
============================================
*/



bloc-touche[data-touche="’"] div,
bloc-touche[data-touche="!"] div {
    line-height: 1.3;
}

bloc-touche[data-touche="AltTab"] div {
	font-size: calc(var(--taille-texte-touche) / 1.8);
	line-height: 1.15;
}

bloc-touche[data-touche="LShift"] div,
bloc-touche[data-touche="RShift"] div,
bloc-touche[data-touche="CapsLock"] div {
    font-weight: bold;
}

bloc-touche[data-touche="LAlt"] div,
bloc-touche[data-touche="RAlt"] div,
bloc-touche[data-touche="LCtrl"] div,
bloc-touche[data-touche="RCtrl"] div,
bloc-touche[data-touche="Space"] div,
bloc-touche[data-touche="Win"] div,
bloc-touche[data-touche="Option"] div {
    font-size: calc(var(--taille-texte-touche) * 0.7);
}





/* ======= Couche Visuel ======= */


ensemble-clavier[data-couche="Visuel"] bloc-touche[data-type="lettre"] div,
ensemble-clavier[data-couche="Visuel"] bloc-touche[data-type="français"] div {
	text-transform: uppercase;
}

ensemble-clavier[data-couche="Visuel"] bloc-touche[data-type="double"] div {
    line-height: 1.1;
    font-size: calc(var(--taille-texte-touche) * 0.7);
}

ensemble-clavier[data-couche="Visuel"][data-plus="oui"] bloc-touche[data-touche="q"] div {
	text-transform: capitalize;
}

ensemble-clavier[data-couche="Visuel"] bloc-touche[data-touche="Space"] div::before {
	content: "HyperTexte v.1.0";
	color:hsl(0, 0, 30%);
}





/* ======= Corrections localisées ======= */


ensemble-clavier[data-couche="AltGr"][data-plus=oui] bloc-touche[data-touche="y"] div {
	font-size: 1.8em;
}

ensemble-clavier[data-couche="AltGr"][data-plus=oui] bloc-touche[data-touche="CapsLock"] div {
	font-size: 0.7em;
}

ensemble-clavier[data-couche="AltGr"][data-plus=oui] bloc-touche[data-touche="Tab"] div {
	font-size: 0.6em;
}

ensemble-clavier[data-couche="layer"] bloc-touche[data-touche="à"] div,
ensemble-clavier[data-couche="layer"] bloc-touche[data-touche="c"] div,
ensemble-clavier[data-couche="layer"] bloc-touche[data-touche="d"] div,
ensemble-clavier[data-couche="layer"] bloc-touche[data-touche="’"] div,
ensemble-clavier[data-couche="layer"] bloc-touche[data-touche="w"] div,
ensemble-clavier[data-couche="layer"] bloc-touche[data-touche="x"] div {
	font-size: 0.8em;
}


/* Car les glyphes des touches mortes s’affichent mal sinon */
bloc-touche[data-touche="CapsLock"] div,
bloc-touche[data-touche="Enter"] div,
ensemble-clavier[data-couche="Visuel"] bloc-touche[data-touche="!"] div,
ensemble-clavier[data-couche="Primary"] bloc-touche[data-touche="!"] div,
ensemble-clavier[data-couche="AltGr"] bloc-touche[data-touche="j"] div {
	font-weight: normal;
}







/*
=============================
======= Touche Entrée =======
=============================
*/



bloc-touche[data-type="enter"]{ 
    top: 0;
    position: relative;
	z-index: 1;
	border-right: none;
}


bloc-touche[data-type="enter"] div {
    z-index: 3;
}



bloc-touche[data-type="enter"]::before {
    /* On cache la jonction entre l’élément et l’after avec un rectangle */
    position: absolute;
    top: 0;
    right: 0;
    z-index: 2;
    content: '';
    height: var(--taille-touche);
    width: calc(var(--taille-touche) - 2 * var(--marge-touche) - 1px);
    background-color: var(--couleur-fond-touche);
	border-radius: 0 calc(var(--arrondi-touche) - 1px) 0 0;
    border-right: var(--taille-bordure-touche) solid var(--couleur-bordure-touche);
}

bloc-touche[data-type="enter"]::after {
    position: absolute;
    top: 100%;
    right: 0;
    z-index: 0;
	content: '';
    height: calc(var(--taille-touche) + var(--marge-touche) / 2);
    width: calc(var(--taille-touche) - 2 * var(--marge-touche));
    background-color: var(--couleur-fond-touche);
    border: var(--taille-bordure-touche) solid var(--couleur-bordure-touche);
    border-top: none;
    border-radius: 0 0 var(--arrondi-touche) var(--arrondi-touche);
    box-shadow: var(--ombre-touche), 0 var(--profondeur-touche) 0 var(--effet-3d), -0.5px var(--profondeur-touche) 0 var(--effet-3d);
}



bloc-touche[data-type="enter"]:active,
bloc-touche[data-type="enter"]:hover {
    position: relative;
    top: var(--descente-touche);
}

bloc-touche[data-type="enter"]:active::before,
bloc-touche[data-type="enter"]:hover::before {
    height: var(--taille-touche);
}

bloc-touche[data-type="enter"]:active::after,
bloc-touche[data-type="enter"]:hover::after {
    box-shadow: 0 var(--profondeur-touche-pressee) 0 var(--effet-3d), 0 var(--profondeur-touche-pressee) 0 var(--effet-3d);
}







/*
========================
======= Couleurs =======
========================
*/



/* Couleur des touches par doigt et main */

bloc-touche[data-main="gauche"][data-doigt="index"]{
    --couleur-touche: var(--couleur-doigt-gauche-index);
}
bloc-touche[data-main="gauche"][data-doigt="majeur"]{
    --couleur-touche: var(--couleur-doigt-gauche-majeur);
}
bloc-touche[data-main="gauche"][data-doigt="annulaire"]{
    --couleur-touche: var(--couleur-doigt-gauche-annulaire);
}
bloc-touche[data-main="gauche"][data-doigt="auriculaire"]{
    --couleur-touche: var(--couleur-doigt-gauche-auriculaire);
}
bloc-touche[data-main="droite"][data-doigt="index"]{
    --couleur-touche: var(--couleur-doigt-droite-index);
}
bloc-touche[data-main="droite"][data-doigt="majeur"]{
    --couleur-touche: var(--couleur-doigt-droite-majeur);
}
bloc-touche[data-main="droite"][data-doigt="annulaire"]{
    --couleur-touche: var(--couleur-doigt-droite-annulaire);
}
bloc-touche[data-main="droite"][data-doigt="auriculaire"]{
    --couleur-touche: var(--couleur-doigt-droite-auriculaire);
}



/* Couleur des touches spéciales */

bloc-touche[data-type="space"],
bloc-touche[data-type="special"],
bloc-touche[data-type="enter"],
bloc-touche[data-type="enter"]::before,
bloc-touche[data-type="enter"]::after {
    background-color: rgb(14, 14, 14);
	color: white;
	/* Bordure de la touche en blanc transparent */
	--couleur-touche: 0deg; 
    --couleur-touche-saturation: 0%;
}

bloc-touche[data-type="space"] {
	background-color: rgba(255, 255, 255, 0.1);
}

.touche-active {
	color: black!important;
	background-color: rgba(255, 255, 255, 0.7)!important;
}



/* Si pas de couleur, ou couleur spéciale */

ensemble-clavier[data-couleur="non"] bloc-touche,
ensemble-clavier[data-couleur="freq"] bloc-touche {
    --couleur-touche: 0deg;
    --couleur-touche-saturation: 0%;
    --couleur-touche-luminosite: 100%;
}

ensemble-clavier[data-couleur="non"] bloc-touche[data-type="space"],
ensemble-clavier[data-couleur="freq"] bloc-touche[data-type="space"]{
	background-color: var(--couleur-fond-touche);
}

ensemble-clavier[data-couleur="freq"] bloc-touche[data-type = "lettre"] {
    --couleur-touche: calc(35deg * (0 - var(--frequence-log)) );
    --couleur-touche-saturation: 80%;
    --couleur-touche-luminosite: 50%;
	--transparence-touche: 35%;
	background-color: hsla( var(--couleur-touche), 100%, 80%, var(--transparence-touche));
}